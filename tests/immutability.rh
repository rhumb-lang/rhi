% 1. Local Immutability Success
x := 10
x .= 20   % Transition to Immutable
x %= 20 % can transition from mutable to immutable and it doesn't affect data values

% 2. Local Immutability Failure
err := [] +> (
    x := 30
) {
    #***(*; msg; *) .. msg
} %= 'cannot assign value to immutable label'

err2 := [] +> (
    x .= 30
) {
    #***(*; msg; *) .. msg
} %= 'cannot assign value to immutable label'

% 3. Map Literal Immutability
m := [
    fixed .. "static"
    fluid :: "dynamic"
]

% Read works
m\fixed %= 'static' % can use immutable field assign op

% Write fails
err3 := [] +> (
    m\fixed := "changed"
) { #***(*; m; *) .. m } %= 'cannot assign value to immutable field 'fixed''

% 4. Dynamic Map Freezing
m\fluid .= "frozen now"
m\fluid %= 'frozen now'

% Write now fails
err4 := [] +> (
    m\fluid := "changed again"
) { #***(*; m; *) .. m } %= 'cannot assign value to immutable field 'fluid''